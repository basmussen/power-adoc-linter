= Regel-Beziehungen und AbhÃ¤ngigkeiten
:toc:
:toc-title: Inhalt
:toclevels: 3
:icons: font
:source-highlighter: highlight.js

[abstract]
Dieses Dokument visualisiert die komplexen Beziehungen zwischen verschiedenen Validierungsregeln im Power AsciiDoc Linter. Verstehen Sie, wie Regeln interagieren und sich gegenseitig beeinflussen.

== ğŸ•¸ï¸ Regel-Netzwerk

[plantuml, rule-network, svg]
----
@startuml
!theme plain
skinparam defaultFontSize 12
skinparam rectangleFontSize 10

' Document Level
rectangle "Document" as doc #lightblue

' Metadata Branch
rectangle "Metadata" as meta #lightgreen
rectangle "Attributes[]" as attrs #palegreen

' Section Branch  
rectangle "Sections[]" as secs #lightyellow
rectangle "Subsections[]" as subsecs #palegoldenrod
rectangle "Blocks[]" as blocks #wheat

' Severity Flow
rectangle "Section\nSeverity" as secsev #pink
rectangle "Block\nSeverity" as blocksev #lightpink
rectangle "Rule\nSeverity" as rulesev #lavenderblush

' Connections
doc --> meta : contains
doc --> secs : contains
meta --> attrs : has
secs --> subsecs : can have
secs --> blocks : allows
subsecs --> blocks : allows

' Severity inheritance
secsev ..> blocksev : inherits to
blocksev ..> rulesev : inherits to
secs --> secsev : defines
blocks --> blocksev : can override
blocks --> rulesev : rules can override

' Annotations
note right of attrs
  Each attribute has:
  - name
  - pattern
  - min/maxLength
  - required
  - severity
end note

note bottom of blocks
  Block types:
  - paragraph
  - listing
  - table
  - image
  - etc.
end note
@enduml
----

== ğŸ”„ Regel-Interaktionen

=== 1. Hierarchische AbhÃ¤ngigkeiten

[.text-center]
....
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DOCUMENT LEVEL                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    METADATA     â”‚         â”‚     SECTIONS       â”‚    â”‚
â”‚  â”‚                 â”‚         â”‚                    â”‚    â”‚
â”‚  â”‚  Definiert:     â”‚         â”‚  Definiert:        â”‚    â”‚
â”‚  â”‚  â€¢ Kopfdaten    â”‚         â”‚  â€¢ Struktur        â”‚    â”‚
â”‚  â”‚  â€¢ Pflichtfelderâ”‚         â”‚  â€¢ Hierarchie      â”‚    â”‚
â”‚  â”‚                 â”‚         â”‚  â€¢ Erlaubte Inhalteâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚           â”‚                            â”‚                â”‚
â”‚           â–¼                            â–¼                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚          GEGENSEITIGE EINFLÃœSSE      â”‚            â”‚
â”‚    â”‚  â€¢ Metadata kann Section-Namen       â”‚            â”‚
â”‚    â”‚    beeinflussen (z.B. Sprache)       â”‚            â”‚
â”‚    â”‚  â€¢ Sections kÃ¶nnen spezielle         â”‚            â”‚
â”‚    â”‚    Metadata erfordern                â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
....

=== 2. Konditionale Regeln

Manche Regeln werden nur unter bestimmten Bedingungen aktiv:

[plantuml, conditional-rules, svg]
----
@startuml
start
:Dokument laden;

if (Metadata: api-version vorhanden?) then (ja)
  :API-spezifische Sections\nerforderlich;
  :Endpunkte Section: PFLICHT;
  :Response Codes Section: PFLICHT;
else (nein)
  :Standard Sections;
  :Flexible Struktur;
endif

if (Section: "Code Examples" vorhanden?) then (ja)
  :Listing Blocks mÃ¼ssen\nSprache definieren;
  :Severity: ERROR;
else (nein)
  :Listing Sprache optional;
  :Severity: INFO;
endif

stop
@enduml
----

=== 3. Kaskadierende Validierung

[.text-center]
....
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      VALIDIERUNGS-KASKADE                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. STRUKTUR-VALIDIERUNG                                    â”‚
â”‚     â””â”€â–º Sind alle Pflicht-Sections vorhanden?              â”‚
â”‚         â””â”€â–º Ist die Hierarchie korrekt?                    â”‚
â”‚                                                             â”‚
â”‚  2. INHALTS-VALIDIERUNG                                     â”‚
â”‚     â””â”€â–º Enthalten Sections erlaubte Blocks?                â”‚
â”‚         â””â”€â–º ErfÃ¼llen Blocks ihre Anforderungen?            â”‚
â”‚                                                             â”‚
â”‚  3. KONSISTENZ-VALIDIERUNG                                  â”‚
â”‚     â””â”€â–º Passen Metadaten zur Struktur?                     â”‚
â”‚         â””â”€â–º Sind Querverweise gÃ¼ltig?                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
....

== ğŸ­ Regel-Szenarien

=== Szenario 1: Dokumenttyp-basierte Regeln

[cols="25,35,40", options="header"]
|===
| Dokumenttyp | Aktivierte Regeln | Besonderheiten

| API-Dokumentation
a| 
* Strikte Section-Reihenfolge
* HTTP-Methoden als Subsections
* Code-Beispiele erforderlich
| Pattern-Matching fÃ¼r Endpunkte

| Benutzerhandbuch
a|
* Flexible Kapitelstruktur
* Bilder mit Alt-Text
* Glossar optional
| Niedrigere Severity-Level

| Release Notes
a|
* Versions-Metadaten Pflicht
* Breaking Changes Section
* Chronologische Ordnung
| Datums-Validierung kritisch
|===

=== Szenario 2: Severity-Ãœberschreibungen

[source,yaml]
----
# Basis-Konfiguration
sections:
  - name: "Dokumentation"
    severity: warn          # <1>
    blocks:
      - paragraph:
          severity: warn    # <2>
          sentences:
            min: 3
            severity: error # <3>
            
# Resultierende Validierung:
# - Section fehlt â†’ WARN
# - Paragraph fehlt â†’ WARN  
# - Weniger als 3 SÃ¤tze â†’ ERROR! (Ã¼berschreibt)
----

<1> Section-Level Default
<2> Erbt von Section
<3> Ãœberschreibt Block-Level

== ğŸ” Komplexe Regel-Muster

=== Pattern 1: Gegenseitige AusschlÃ¼sse

[plantuml, mutual-exclusion, svg]
----
@startuml
!theme plain

state "Dokument Start" as start
state "Hat FAQ Section?" as faq_check
state "Hat Q&A Section?" as qa_check
state "Fehler: Beide\nvorhanden" as error #pink
state "OK" as ok #lightgreen

start --> faq_check
faq_check --> qa_check : Ja
faq_check --> ok : Nein

qa_check --> error : Ja
qa_check --> ok : Nein

note right of error
  FAQ und Q&A Sections
  schlieÃŸen sich gegenseitig aus
end note
@enduml
----

=== Pattern 2: AbhÃ¤ngige Anforderungen

[.text-center]
....
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           WENN â†’ DANN BEZIEHUNGEN               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  WENN version > 2.0                             â”‚
â”‚  DANN migration-guide ERFORDERLICH              â”‚
â”‚                                                 â”‚
â”‚  WENN api-version definiert                     â”‚
â”‚  DANN api-base-url ERFORDERLICH                â”‚
â”‚                                                 â”‚
â”‚  WENN images vorhanden                          â”‚
â”‚  DANN :imagesdir: ERFORDERLICH                 â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
....

=== Pattern 3: KontextabhÃ¤ngige Validierung

[cols="30,35,35", options="header"]
|===
| Kontext | Standard-Regel | KontextabhÃ¤ngige Regel

| Code-Listing in Tutorial
| Sprache optional
| Sprache PFLICHT + Zeilennummern

| Tabelle in API-Docs
| Keine speziellen Anforderungen
| Header PFLICHT + Caption mit "Parameter"

| Bild in Benutzerhandbuch
| Alt-Text empfohlen
| Alt-Text PFLICHT + Bildunterschrift
|===

== ğŸ¯ Regel-Optimierung

=== Tipps zur Regel-Definition

[IMPORTANT]
====
**Regel-Hierarchie beachten**

1. Definieren Sie allgemeine Regeln auf hÃ¶chster Ebene
2. Spezialisieren Sie nur wo nÃ¶tig
3. Nutzen Sie Vererbung statt Wiederholung
====

=== Anti-Patterns vermeiden

[cols="50,50", options="header"]
|===
| âŒ Anti-Pattern | âœ… Best Practice

a|
[source,yaml]
----
# Redundante Severity
blocks:
  - paragraph:
      severity: error
      lines:
        severity: error
      sentences:
        severity: error
----

a|
[source,yaml]
----
# Severity vererben
blocks:
  - paragraph:
      severity: error
      # Regeln erben error
      lines:
        min: 5
      sentences:
        min: 3
----

a|
[source,yaml]
----
# Zu spezifische Patterns
sections:
  - name: "Kapitel 1: Einleitung"
  - name: "Kapitel 2: Installation"
  - name: "Kapitel 3: Konfiguration"
----

a|
[source,yaml]
----
# Flexible Patterns
sections:
  - pattern: "^Kapitel \\d+:.*"
    min: 3
    max: 10
----
|===

== ğŸ“Š Regel-Metriken

=== KomplexitÃ¤ts-Analyse

[plantuml, complexity-metrics, svg]
----
@startuml
!theme plain

title Regel-KomplexitÃ¤t nach Komponente

skinparam defaultFontSize 14

rectangle "Metadata\nRegeln" as meta #lightgreen {
  note right : KomplexitÃ¤t: Niedrig\n- Flache Struktur\n- Klare Attribute
}

rectangle "Section\nRegeln" as sec #yellow {
  note right : KomplexitÃ¤t: Mittel\n- Hierarchisch\n- Patterns
}

rectangle "Block\nRegeln" as block #orange {
  note right : KomplexitÃ¤t: Hoch\n- Viele Typen\n- Typ-spezifisch
}

rectangle "Kombinierte\nRegeln" as comb #red {
  note right : KomplexitÃ¤t: Sehr hoch\n- AbhÃ¤ngigkeiten\n- Konditional
}

meta -[hidden]-> sec
sec -[hidden]-> block
block -[hidden]-> comb
@enduml
----


== ğŸ”— WeiterfÃ¼hrende Ressourcen

* link:rule-hierarchy-diagram.adoc[Regel-Hierarchie Ãœbersicht]
* link:severity-inheritance-diagram.adoc[Severity-Vererbung im Detail]
* link:../reference/rules/index.adoc[VollstÃ¤ndige Regel-Referenz]
* link:../troubleshooting.adoc#regel-konflikte[Troubleshooting: Regel-Konflikte]