= Troubleshooting Guide
:toc:
:toc-title: Inhalt
:toclevels: 3
:icons: font
:source-highlighter: rouge

[abstract]
Dieser Guide hilft Ihnen bei der L√∂sung h√§ufiger Probleme mit dem Power AsciiDoc Linter. Finden Sie schnell L√∂sungen f√ºr typische Fehlermeldungen und Konfigurationsprobleme.

== üö® H√§ufige Probleme

=== Dateien werden nicht gefunden

[cols="1,3", grid=none]
|===
| **Problem**
| Der Linter findet keine Dateien, obwohl sie existieren

| **Symptom**
| `No files found matching pattern: **/*.adoc`

| **L√∂sung**
a|
1. Glob-Pattern in Anf√ºhrungszeichen setzen:
+
[source,bash]
----
# ‚úÖ Richtig
java -jar power-adoc-linter.jar -i "**/*.adoc"

# ‚ùå Falsch
java -jar power-adoc-linter.jar -i **/*.adoc
----

2. Arbeitsverzeichnis pr√ºfen:
+
[source,bash]
----
pwd  # Aktuelles Verzeichnis anzeigen
ls -la *.adoc  # Dateien im aktuellen Verzeichnis
----

3. Explizite Pfade verwenden:
+
[source,bash]
----
java -jar power-adoc-linter.jar -i "docs/**/*.adoc,src/**/*.adoc"
----
|===

=== Java-Version Probleme

[cols="1,3", grid=none]
|===
| **Problem**
| `UnsupportedClassVersionError` oder √§hnliche Fehler

| **Symptom**
| 
[source]
----
Error: LinkageError occurred while loading main class
java.lang.UnsupportedClassVersionError: ... compiled with preview features
----

| **L√∂sung**
a|
1. Java-Version pr√ºfen:
+
[source,bash]
----
java -version
# Sollte 17 oder h√∂her sein
----

2. Falls zu alt, Java 17+ installieren:
+
[tabs]
====
Ubuntu/Debian::
+
[source,bash]
----
sudo apt update
sudo apt install openjdk-17-jdk
----

macOS::
+
[source,bash]
----
brew install openjdk@17
----

Windows::
+
Download von https://adoptium.net/
====

3. JAVA_HOME setzen:
+
[source,bash]
----
export JAVA_HOME=/pfad/zu/java17
export PATH=$JAVA_HOME/bin:$PATH
----
|===

=== Konfigurationsdatei wird nicht geladen

[cols="1,3", grid=none]
|===
| **Problem**
| Konfiguration wird ignoriert oder Fehler beim Laden

| **Symptom**
| `Configuration file not found` oder `Invalid configuration`

| **L√∂sung**
a|
1. Dateipfad pr√ºfen:
+
[source,bash]
----
# Relativer Pfad
java -jar power-adoc-linter.jar -c .linter-config.yaml

# Absoluter Pfad
java -jar power-adoc-linter.jar -c /home/user/projekt/.linter-config.yaml
----

2. YAML-Syntax validieren:
+
[source,bash]
----
# Online-Validator nutzen oder:
python -c "import yaml; yaml.safe_load(open('.linter-config.yaml'))"
----

3. Minimal-Konfiguration testen:
+
[source,yaml]
----
document:
  metadata:
    attributes:
      - name: title
        required: true
        severity: error
----
|===

== üîß Konfigurationsprobleme

=== Schema-Validierungsfehler

[cols="1,3", grid=none]
|===
| **Problem**
| `Schema validation failed for configuration`

| **Symptom**
| Fehlermeldung mit JSON-Schema Details

| **L√∂sung**
a|
1. Pflichtfelder pr√ºfen:
   - Jeder Block braucht `severity`
   - Sections brauchen `level`
   - Attributes brauchen `name`

2. Typen √ºberpr√ºfen:
+
[source,yaml]
----
# ‚úÖ Richtig
sections:
  - name: "Test"
    level: 1      # Zahl, nicht String!
    severity: error

# ‚ùå Falsch
sections:
  - name: "Test"
    level: "1"    # String statt Zahl
    severity: error
----

3. Erlaubte Werte:
   - severity: `error`, `warn`, `info`
   - level: 1-6 (positive Zahlen)
|===

=== Severity-Vererbung funktioniert nicht

[cols="1,3", grid=none]
|===
| **Problem**
| Erwartete Severity wird nicht angewendet

| **Symptom**
| Falsche Severity-Level in der Ausgabe

| **L√∂sung**
a|
1. Hierarchie verstehen:
+
[source,yaml]
----
sections:
  - name: "Test"
    severity: warn      # Section-Level
    blocks:
      - paragraph:
          severity: error   # Block-Level (√ºberschreibt Section)
          lines:
            min: 5
            severity: info  # Rule-Level (h√∂chste Priorit√§t)
----

2. Explizite Severity setzen:
+
[source,yaml]
----
# Wenn unsicher, immer explizit setzen
- paragraph:
    severity: error  # Nicht vergessen!
    minLines: 5
----

3. Debug-Output nutzen:
+
[source,bash]
----
java -Dlog4j.configurationFile=debug-log4j2.xml -jar power-adoc-linter.jar
----
|===

=== Pattern-Matching schl√§gt fehl

[cols="1,3", grid=none]
|===
| **Problem**
| Regul√§re Ausdr√ºcke funktionieren nicht wie erwartet

| **Symptom**
| `does not match required pattern`

| **L√∂sung**
a|
1. Escaping beachten (doppelte Backslashes in YAML):
+
[source,yaml]
----
# ‚úÖ Richtig
pattern: "\\d{4}-\\d{2}-\\d{2}"     # Datum-Pattern

# ‚ùå Falsch
pattern: "\d{4}-\d{2}-\d{2}"       # Backslashes fehlen
----

2. Anchors verwenden:
+
[source,yaml]
----
# Ganzer String muss matchen
pattern: "^[A-Z].*\\.$"   # Beginnt mit Gro√übuchstabe, endet mit Punkt
----

3. Pattern testen:
+
[source,java]
----
// Online Regex-Tester verwenden oder kleines Test-Programm
String pattern = "\\d{4}-\\d{2}-\\d{2}";
String test = "2024-01-15";
System.out.println(test.matches(pattern)); // true
----
|===

== üìä Performance-Probleme

=== Linter ist langsam

[cols="1,3", grid=none]
|===
| **Problem**
| Validierung dauert sehr lange

| **Symptom**
| Mehr als 1 Sekunde pro Datei

| **L√∂sung**
a|
1. Speicher erh√∂hen:
+
[source,bash]
----
java -Xmx2g -jar power-adoc-linter.jar -i "**/*.adoc"
----

2. Dateien begrenzen:
+
[source,bash]
----
# Nur bestimmte Verzeichnisse
java -jar power-adoc-linter.jar -i "docs/**/*.adoc"

# Excludes nutzen (wenn implementiert)
java -jar power-adoc-linter.jar -i "**/*.adoc" --exclude "**/build/**"
----

3. Einfachere Patterns:
+
[source,yaml]
----
# Komplexe Patterns vermeiden
pattern: "^(?:GET|POST|PUT|DELETE)\\s+/api/v\\d+/[\\w-]+(?:/[\\w-]+)*$"

# Besser: Einfachere Alternative
pattern: "^(GET|POST|PUT|DELETE)\\s+/api/.*"
----
|===

=== OutOfMemoryError

[cols="1,3", grid=none]
|===
| **Problem**
| `java.lang.OutOfMemoryError: Java heap space`

| **Symptom**
| Linter st√ºrzt bei gro√üen Dateien ab

| **L√∂sung**
a|
1. Heap-Gr√∂√üe erh√∂hen:
+
[source,bash]
----
# 4GB Heap
java -Xmx4g -jar power-adoc-linter.jar -i "**/*.adoc"
----

2. Batch-Verarbeitung:
+
[source,bash]
----
# Verzeichnisse einzeln verarbeiten
for dir in */; do
    java -jar power-adoc-linter.jar -i "$dir**/*.adoc"
done
----

3. Gro√üe Dateien aufteilen oder excludieren
|===

== üêõ Validierungsfehler verstehen

=== "Missing required attribute"

**Bedeutung**: Ein Pflicht-Metadatenfeld fehlt

**Beispiel**:
[source]
----
ERROR: Missing required attribute 'author': actual not present, expected non-empty value
----

**L√∂sung**:
[source,asciidoc]
----
= Mein Dokument
Max Mustermann <max@example.com>    // <-- Author hinzuf√ºgen
:revdate: 2024-01-15
----

=== "Section has wrong level"

**Bedeutung**: Section-Hierarchie stimmt nicht

**Beispiel**:
[source]
----
ERROR: Section 'Details' has wrong level: actual level 3, expected level 2
----

**L√∂sung**:
[source,asciidoc]
----
== Hauptkapitel

=== Details        // Richtig: Level 2 (===)
// statt
==== Details       // Falsch: Level 3 (====)
----

=== "Too many sections"

**Bedeutung**: Maximum √ºberschritten

**Beispiel**:
[source]
----
ERROR: Too many sections 'Example': actual 5 found, expected maximum 3
----

**L√∂sung**:
- Sections reduzieren oder
- Maximum in Konfiguration erh√∂hen:
+
[source,yaml]
----
- pattern: "^Example \\d+:"
  max: 10    # Erh√∂ht von 3 auf 10
----

== üõ†Ô∏è Debug-Modus

=== Logging aktivieren

Erstellen Sie `debug-log4j2.xml`:

[source,xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">
    <Appenders>
        <Console name="Console" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/>
        </Console>
    </Appenders>
    <Loggers>
        <Logger name="com.example.linter" level="DEBUG"/>
        <Root level="INFO">
            <AppenderRef ref="Console"/>
        </Root>
    </Loggers>
</Configuration>
----

Verwenden:
[source,bash]
----
java -Dlog4j.configurationFile=debug-log4j2.xml -jar power-adoc-linter.jar -i "test.adoc"
----

=== Validierungs-Details anzeigen

[source,bash]
----
# Verbose-Modus (wenn implementiert)
java -jar power-adoc-linter.jar -i "test.adoc" -v

# JSON-Output f√ºr Details
java -jar power-adoc-linter.jar -i "test.adoc" -f json
----

== üí° Best Practices zur Fehlervermeidung

=== 1. Schrittweise vorgehen

[source,bash]
----
# Schritt 1: Ohne Konfiguration testen
java -jar power-adoc-linter.jar -i "test.adoc"

# Schritt 2: Minimal-Konfiguration
java -jar power-adoc-linter.jar -i "test.adoc" -c minimal.yaml

# Schritt 3: Volle Konfiguration
java -jar power-adoc-linter.jar -i "test.adoc" -c full-config.yaml
----

=== 2. Konfiguration validieren

[source,yaml]
----
# test-config.yaml
document:
  metadata:
    attributes:
      - name: test
        required: true
        severity: error
----

[source,bash]
----
# Nur Konfiguration testen
java -jar power-adoc-linter.jar --validate-config -c test-config.yaml
----

=== 3. Beispieldateien nutzen

Erstellen Sie Test-Dokumente f√ºr Ihre Konfiguration:

[source,asciidoc]
----
// valid-example.adoc
= G√ºltiges Beispiel
Max Mustermann
v1.0, 2024-01-15

== Einleitung
Dieser Text erf√ºllt alle Anforderungen.
----

== üÜò Hilfe und Support

=== Weitere Ressourcen

[cols="1,3"]
|===
| üìö | link:user-guide/configuration.adoc[Konfigurations-Guide]
| üìñ | link:reference/rules/index.adoc[Regel-Referenz]
| üí¨ | link:https://github.com/basmussen/power-adoc-linter/discussions[GitHub Discussions]
| üêõ | link:https://github.com/basmussen/power-adoc-linter/issues[Issue Tracker]
|===

=== Issue melden

Wenn Sie ein Problem nicht l√∂sen k√∂nnen:

1. Minimal-Beispiel erstellen
2. Vollst√§ndige Fehlermeldung kopieren
3. Konfiguration und AsciiDoc-Datei bereitstellen
4. Issue auf GitHub erstellen:

[source,markdown]
----
**Beschreibung**
Kurze Problembeschreibung

**Reproduktion**
1. Konfiguration: `config.yaml`
2. Befehl: `java -jar ...`
3. Erwartetes Ergebnis
4. Tats√§chliches Ergebnis

**Umgebung**
- Linter Version: 1.0.0
- Java Version: 17
- OS: Linux/Windows/macOS
----

== üîç Checkliste f√ºr h√§ufige Fehler

Bevor Sie ein Issue erstellen, pr√ºfen Sie:

‚òê Java 17+ installiert? +
‚òê Glob-Pattern in Anf√ºhrungszeichen? +
‚òê Konfigurationsdatei existiert? +
‚òê YAML-Syntax korrekt? +
‚òê Alle Pflichtfelder gesetzt? +
‚òê Severity-Level korrekt geschrieben? +
‚òê Pattern-Escaping (doppelte Backslashes)? +
‚òê Dateipfade korrekt?